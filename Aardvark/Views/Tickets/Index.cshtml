@model IEnumerable<Aardvark.Models.Ticket>
@using Aardvark.Helpers;
<div id="content">
    <div id="content-header">
        <h1>@ViewBag.Scope Tickets</h1>
    </div> <!-- #content-header -->
    <div id="content-container">
        <h3>Ticket Index</h3>

        <p>
            @Html.ActionLink("Create New Ticket", "Create")
        </p>
        <br />
        <div class="table-responsive">
            <table class="table table-striped table-bordered" id="table-Users">
                <colgroup>
                    <col width="90" /> <!-- Rec # -->
                    <col width="90" /> <!-- Assigned -->
                    <col width="90" /> <!-- Owner -->
                    <col width="90" /> <!-- Project -->
                    <col width="90" /> <!-- Skill -->
                    <col width="90" /> <!-- Priority -->
                    <col width="90" /> <!-- Status -->
                    <col width="90" /> <!-- Type -->
                    <col width="120" /> <!-- Title -->
                    <col width="180" /> <!-- Description -->
                    <col width="90" /> <!-- Created -->
                    <col width="90" /> <!-- Updated -->
                    <col width="90" /> <!-- MostRecentChange -->
                    <col width="90" /> <!-- Due -->
                    <col width="90" /> <!-- Hours -->
                    <col width="90" /> <!-- Links -->
                </colgroup>
                <thead class="dt-head-center">
                    <tr>
                        <th class="dt-head-center">
                            #
                        </th>
                        <th class="dt-head-center">
                            Assigned
                        </th>
                        <th class="dt-head-center">
                            Owner
                        </th>
                        <th class="dt-head-center">
                            Project
                        </th>
                        <th class="dt-head-center">
                            Skill
                        </th>
                        <th>
                            Priority
                        </th>
                        <th>
                            Status
                        </th>
                        <th>
                            Type
                        </th>
                        <th>
                            Title
                        </th>
                        <th>
                            Description
                        </th>
                        <th>
                            Created
                        </th>
                        <th>
                            Updated
                        </th>
                        <th>
                            Most Recent
                        </th>
                        <th>
                            Due
                        </th>
                        <th>
                            Hours
                        </th>
                        <th></th>
                    </tr>
                </thead>

                <tbody>
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td>
                                @item.Id
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.AssignedToDev.UserName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.OwnerUser.UserName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Project.Name)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.SkillRequired.Name)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.TicketPriority.Name)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.TicketStatus.Name)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.TicketType.Name)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Title)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Description)
                            </td>
                            <td>
                                @item.Created.ToString("G")
                            </td>
                            <td>
                                @(item.Updated == null ? "" : item.Updated.Value.ToString("G"))
                            </td>
                            <td>
                                @(item.MostRecentUpdate.ToString("G"))
                            </td>
                            @{
                                string[] dueStat = ProjectsHelper.TicketDueStatus(item.DueDate);
                            }
                            <td class="@dueStat[1]">
                                @item.DueDate.ToString("MM/dd/yyyy")
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.HoursToComplete)
                            </td>
                            <td>
                                <a href="@Url.Action("Edit", new { id = item.Id })"><i class="fa fa-pencil-square-o"></i></a>
                                <br />
                                <a href="@Url.Action("Details", new { id = item.Id })"><i class="fa fa-folder-open-o"></i></a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

@if (ViewBag.Scope == "My")
{
    @section Scripts {
        @*<script src="~/js/DataTables-1.10.7/media/js/jquery.dataTables.min.js"></script>*@
        @*<script>
            $(document).ready(function () {
                $('#table_id').DataTable({
                    "pageLength": 25
                });
            });
        </script>*@

        <script>
            $(document).ready(function () {
                $('#sidebar-Tickets').addClass('active');
                $('#sidebar-Tickets-My').addClass('active');
            });
        </script>
    }
}
else
{
    @section Scripts {
        <script>
            $(document).ready(function () {
                $('#sidebar-Tickets').addClass('active');
                $('#sidebar-Tickets-All').addClass('active');
            });
        </script>
    }
}
